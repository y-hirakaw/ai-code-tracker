# AI Code Tracker - Requirements and Design Document (RDD)

## 1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

**AI Code Tracker (AICT)** ã¯ã€AIï¼ˆClaude Codeç­‰ï¼‰ã¨äººé–“ãŒæ›¸ã„ãŸã‚³ãƒ¼ãƒ‰ã®å‰²åˆã‚’æ­£ç¢ºã«è¿½è·¡ã™ã‚‹è¶…è»½é‡ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚

### ä¸»è¦æ©Ÿèƒ½
- **è‡ªå‹•è¿½è·¡**: Claude Codeãƒ»Git hooks çµ±åˆã«ã‚ˆã‚‹è‡ªå‹•ã‚³ãƒ¼ãƒ‰å¤‰æ›´è¨˜éŒ²
- **è¶…è»½é‡ãƒ‡ãƒ¼ã‚¿**: JSONLå½¢å¼ã§1ãƒ¬ã‚³ãƒ¼ãƒ‰ç´„100ãƒã‚¤ãƒˆï¼ˆå¾“æ¥æ¯”70%å‰Šæ¸›ï¼‰
- **æœŸé–“æŒ‡å®šãƒ¬ãƒãƒ¼ãƒˆ**: è¤‡æ•°å‡ºåŠ›ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼ˆtable/graph/json/csvï¼‰å¯¾å¿œ
- **ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ãƒˆè¨­å®š**: æ—¢å­˜ãƒ•ãƒƒã‚¯ã¨ã®å®‰å…¨ãªãƒãƒ¼ã‚¸æ©Ÿèƒ½
- **é«˜é€Ÿåˆ†æ**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å·®åˆ†è¨ˆç®—ã¨ã‚¹ãƒãƒ¼ãƒˆã‚¹ã‚­ãƒƒãƒ—

### æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯
- **è¨€èª**: Go 1.21+
- **ãƒ‡ãƒ¼ã‚¿**: JSONLï¼ˆJSON Linesï¼‰
- **é€£æº**: Claude Code hooks, Git hooks
- **å¯¾è±¡**: è¨­å®šå¯èƒ½ãªãƒ•ã‚¡ã‚¤ãƒ«æ‹¡å¼µå­

## 2. ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ

```
ai-code-tracker/
â”œâ”€â”€ cmd/aict/                  # CLIå®Ÿè£…
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ tracker/               # ã‚³ã‚¢è¿½è·¡ãƒ­ã‚¸ãƒƒã‚¯
â”‚   â”œâ”€â”€ period/                # æœŸé–“æŒ‡å®šæ©Ÿèƒ½ï¼ˆv0.4.0ï¼‰
â”‚   â”œâ”€â”€ interfaces/            # DIã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼ˆv0.5.1ï¼‰
â”‚   â”œâ”€â”€ errors/                # æ§‹é€ åŒ–ã‚¨ãƒ©ãƒ¼ï¼ˆv0.5.1ï¼‰
â”‚   â”œâ”€â”€ validation/            # è¨­å®šãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆv0.5.1ï¼‰
â”‚   â”œâ”€â”€ security/              # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–ï¼ˆv0.5.1ï¼‰
â”‚   â”œâ”€â”€ storage/               # ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–
â”‚   â”œâ”€â”€ git/                   # Gité€£æº
â”‚   â””â”€â”€ templates/             # ãƒ•ãƒƒã‚¯ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
â””â”€â”€ .ai_code_tracking/         # è¿½è·¡ãƒ‡ãƒ¼ã‚¿
    â”œâ”€â”€ config.json            # è¨­å®š
    â”œâ”€â”€ checkpoints.jsonl      # è¶…è»½é‡è¨˜éŒ²
    â””â”€â”€ hooks/                 # è‡ªå‹•ç”Ÿæˆãƒ•ãƒƒã‚¯
```

## 3. ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

```
1. PreToolUse Hook â†’ äººé–“çŠ¶æ…‹è¨˜éŒ²
   â†“
2. Claude Codeç·¨é›†å®Ÿè¡Œ
   â†“  
3. PostToolUse Hook â†’ AIçŠ¶æ…‹è¨˜éŒ²
   â†“
4. Git commit â†’ ãƒ¡ãƒˆãƒªã‚¯ã‚¹æ›´æ–°
```

**JSONLè¨˜éŒ²ä¾‹**:
```json
{"timestamp":"2025-07-31T23:09:14+09:00","author":"claude","added":395,"deleted":271}
```

## 4. è¨­å®šãƒ»ãƒ‡ãƒ¼ã‚¿ä»•æ§˜

### è¨­å®šãƒ•ã‚¡ã‚¤ãƒ« (.ai_code_tracking/config.json)
```json
{
  "target_ai_percentage": 80.0,
  "tracked_extensions": [".go", ".py", ".js", ".ts", ".swift"],
  "exclude_patterns": ["*_generated.go"],
  "author_mappings": {"username": "human"}
}
```

### ä¸»è¦å‹å®šç¾©
```go
// è¶…è»½é‡JSONLå½¢å¼
type CheckpointRecord struct {
    Timestamp time.Time `json:"timestamp"`
    Author    string    `json:"author"`
    Added     int       `json:"added"`
    Deleted   int       `json:"deleted"`
}

// æœŸé–“æŒ‡å®šãƒ¬ãƒãƒ¼ãƒˆ
type PeriodReport struct {
    Range       TimeRange   `json:"range"`
    TotalLines  int         `json:"total_lines"`
    AILines     int         `json:"ai_lines"`
    HumanLines  int         `json:"human_lines"`
    Percentage  float64     `json:"percentage"`
    DailyStats  []DailyStat `json:"daily_stats"`
}
```

## 5. CLIä»•æ§˜

### åŸºæœ¬ã‚³ãƒãƒ³ãƒ‰
```bash
aict init                      # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–
aict setup-hooks               # ãƒ•ãƒƒã‚¯è¨­å®š
aict track -author <name>      # æ‰‹å‹•ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆ
aict report [options]          # ãƒ¬ãƒãƒ¼ãƒˆè¡¨ç¤º
aict reset                     # ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãƒªã‚»ãƒƒãƒˆ
aict config                    # è¨­å®šè¡¨ç¤º
aict version                   # ãƒãƒ¼ã‚¸ãƒ§ãƒ³è¡¨ç¤º
```

### æœŸé–“æŒ‡å®šã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼ˆv0.4.0ï¼‰
```bash
aict report --last 7d                         # ç›´è¿‘7æ—¥
aict report --since "2 weeks ago"             # ç›¸å¯¾æœŸé–“
aict report --from 2025-01-01 --to 2025-01-15 # æœŸé–“ç¯„å›²
aict report --format table|graph|json|csv     # å‡ºåŠ›å½¢å¼
```

## 6. ãƒ¬ãƒãƒ¼ãƒˆå‡ºåŠ›ä¾‹

### ãƒ†ãƒ¼ãƒ–ãƒ«å½¢å¼
```
AI Code Tracking Report
======================
Added Lines: 395
  AI Lines: 395 (100.0%)
  Human Lines: 0 (0.0%)

Target: 80.0% AI code
Progress: 100.0%
```

### ã‚°ãƒ©ãƒ•å½¢å¼
```
Daily AI Percentage Trend:
07-31 [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ] 100.0% (395/395)

Target [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ          ] 80.0%
```

### CSVå½¢å¼ï¼ˆv0.5.0ï¼‰
```csv
Date,AI_Lines,Human_Lines,Total_Lines,AI_Percentage,Target_Percentage,Progress
2025-07-31,395,0,395,100.0,80.0,125.0
```

## 7. é–‹ç™ºå±¥æ­´

| ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | å®Ÿè£…å†…å®¹ | å®Œæˆåº¦ |
|-----------|----------|--------|
| v0.3.0 | åŸºç›¤ãƒ»JSONLè»½é‡åŒ– | âœ… |
| v0.3.7 | Claude/Git hooksçµ±åˆ | âœ… |
| v0.4.0 | æœŸé–“æŒ‡å®šãƒ»è¤‡æ•°å‡ºåŠ›å½¢å¼ | âœ… |
| v0.5.0 | CSVå‡ºåŠ›ãƒ»config command | âœ… |
| v0.5.1 | DIãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ– | âœ… |
| v0.5.2 | å®‰å®šç‰ˆï¼ˆç¾åœ¨ï¼‰ | âœ… |

## 8. å“è³ªæŒ‡æ¨™

- **ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸**: 89.3%ï¼ˆperiod ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼‰
- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**: ã‚³ãƒãƒ³ãƒ‰ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³å¯¾ç­–ã€JSONã‚µã‚¤ã‚ºåˆ¶é™
- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**: 100ãƒã‚¤ãƒˆ/ãƒ¬ã‚³ãƒ¼ãƒ‰ã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åˆ†æ
- **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: æ§‹é€ åŒ–ã‚¨ãƒ©ãƒ¼ã€ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆå¯¾å¿œ
- **ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£**: ä¾å­˜æ€§æ³¨å…¥ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹åˆ†é›¢

## 9. ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãƒ»ä½¿ç”¨æ–¹æ³•

```bash
# ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
go install github.com/y-hirakaw/ai-code-tracker/cmd/aict@latest

# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§åˆæœŸåŒ–
cd your-project
aict init
aict setup-hooks

# è‡ªå‹•è¿½è·¡é–‹å§‹ï¼ˆClaude Codeã§ç·¨é›†ã™ã‚‹ã ã‘ï¼‰
# æ‰‹å‹•è¿½è·¡
aict track -author human
aict track -author claude

# ãƒ¬ãƒãƒ¼ãƒˆè¡¨ç¤º
aict report --last 1w --format csv
```

## 10. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹

**ç¾åœ¨**: **v0.5.2 - ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³é‹ç”¨å¯èƒ½ãªå®‰å®šç‰ˆ**

### é”æˆæ¸ˆã¿
- âœ… å…¨ä¸»è¦æ©Ÿèƒ½å®Ÿè£…å®Œäº†
- âœ… ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºãƒ¬ãƒ™ãƒ«ã®å“è³ªãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
- âœ… åŒ…æ‹¬çš„ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸
- âœ… å®Ÿç”¨çš„ãªæ€§èƒ½ãƒ»è»½é‡æ€§

### å°†æ¥æ‹¡å¼µï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
- ğŸ“‹ è¤‡æ•°AIãƒ„ãƒ¼ãƒ«å¯¾å¿œ
- ğŸ“‹ ãƒãƒ¼ãƒ åˆ†ææ©Ÿèƒ½
- ğŸ“‹ Web UI
- ğŸ“‹ APIæä¾›

**çµè«–**: å®Ÿç”¨ãƒ¬ãƒ™ãƒ«ã«åˆ°é”ã€ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ãƒ¢ãƒ¼ãƒ‰ã«ç§»è¡Œå¯èƒ½