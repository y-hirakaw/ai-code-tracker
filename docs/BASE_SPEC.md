# AI Code Tracker (AICT) åŸºæœ¬ä»•æ§˜æ›¸

## æ¦‚è¦

AI Code Tracker (AICT) ã¯ã€AIã«ã‚ˆã‚‹ã‚³ãƒ¼ãƒ‰ç”Ÿæˆã¨äººé–“ã«ã‚ˆã‚‹ã‚³ãƒ¼ãƒ‰è¨˜è¿°ã‚’è¿½è·¡ãƒ»ç®¡ç†ã™ã‚‹ãŸã‚ã®ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚Claude Code ãªã©ã®AIæ”¯æ´ãƒ„ãƒ¼ãƒ«ã¨Git hookã‚’çµ„ã¿åˆã‚ã›ã¦ã€èª°ãŒã©ã®ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ãŸã‹ã‚’è‡ªå‹•çš„ã«è¨˜éŒ²ã—ã¾ã™ã€‚

## åŸºæœ¬ãƒ•ãƒ­ãƒ¼

### 1. pre-tool-use hook: äººé–“ã®ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆè¨˜éŒ²

**ç›®çš„**: Claude Codeç·¨é›†å‰ã®çŠ¶æ…‹ã‚’ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ

**å‡¦ç†å†…å®¹**:
- Claude CodeãŒç·¨é›†ã‚’é–‹å§‹ã™ã‚‹å‰ã«å®Ÿè¡Œ
- ç¾åœ¨ã®ãƒ¯ãƒ¼ã‚¯ãƒ„ãƒªãƒ¼ã®çŠ¶æ…‹ã‚’ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã¨ã—ã¦ä¿å­˜
- ä½œæˆè€…: `y-hirakaw` (human)
- ä½œæˆè€…ã‚¿ã‚¤ãƒ—: `human`

**ä¿å­˜å ´æ‰€**: `.git/aict/checkpoints/latest.json`

**ãƒ‡ãƒ¼ã‚¿æ§‹é€ **:
```json
{
  "timestamp": "2025-12-10T12:00:00Z",
  "author": "y-hirakaw",
  "type": "human",
  "metadata": {},
  "changes": {},
  "snapshot": {
    "main.go": "package main\n...",
    "utils.go": "package utils\n..."
  }
}
```

### 2. Claude Codeç·¨é›†: AIãŒå®Ÿéš›ã«ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´

**å‡¦ç†å†…å®¹**:
- Claude CodeãŒã‚³ãƒ¼ãƒ‰ã‚’ç·¨é›†ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è¦æ±‚ã«åŸºã¥ãï¼‰
- ãƒ•ã‚¡ã‚¤ãƒ«ã®è¿½åŠ ã€å¤‰æ›´ã€å‰Šé™¤ãªã©

**AIãƒ„ãƒ¼ãƒ«**: Claude Code (claude-sonnet-4.5ãªã©)

### 3. post-tool-use hook: AIã®ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆè¨˜éŒ²

**ç›®çš„**: Claude Codeç·¨é›†å¾Œã®çŠ¶æ…‹ã‚’ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ

**å‡¦ç†å†…å®¹**:
- Claude CodeãŒç·¨é›†ã‚’å®Œäº†ã—ãŸå¾Œã«å®Ÿè¡Œ
- ç¾åœ¨ã®ãƒ¯ãƒ¼ã‚¯ãƒ„ãƒªãƒ¼ã®çŠ¶æ…‹ã‚’ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã¨ã—ã¦ä¿å­˜
- **å‰å›ã®ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆï¼ˆäººé–“ã®ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆï¼‰ã¨ã®å·®åˆ†ã‚’è¨ˆç®—**
- å·®åˆ†ã‚’`Changes`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«è¨˜éŒ²
- ä½œæˆè€…: `Claude Code` (ai)
- ä½œæˆè€…ã‚¿ã‚¤ãƒ—: `ai`
- ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿: ãƒ¢ãƒ‡ãƒ«å (`claude-sonnet-4.5`)

**ä¿å­˜å ´æ‰€**: `.git/aict/checkpoints/latest.json`ï¼ˆè¿½è¨˜ï¼‰

**ãƒ‡ãƒ¼ã‚¿æ§‹é€ **:
```json
{
  "timestamp": "2025-12-10T12:05:00Z",
  "author": "Claude Code",
  "type": "ai",
  "metadata": {
    "model": "claude-sonnet-4.5"
  },
  "changes": {
    "main.go": {
      "added": 10,
      "deleted": 2,
      "lines": [[1, 10]]
    }
  },
  "snapshot": {
    "main.go": "package main\n... (updated)",
    "utils.go": "package utils\n..."
  }
}
```

### 4. git commit: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚³ãƒŸãƒƒãƒˆ

**å‡¦ç†å†…å®¹**:
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ `git commit` ã‚’å®Ÿè¡Œ
- ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¨˜è¿°
- ã‚³ãƒŸãƒƒãƒˆãŒä½œæˆã•ã‚Œã‚‹

**ä¾‹**:
```bash
git add .
git commit -m "feat: Add new feature"
```

### 5. post-commit hook: aict commitå®Ÿè¡Œ

**ç›®çš„**: ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆç¾¤ã‚’Authorship Logã«å¤‰æ›

**å‡¦ç†å†…å®¹**:

#### 5.1 ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆç¾¤ã‚’èª­ã¿è¾¼ã¿
- `.git/aict/checkpoints/latest.json` ã‹ã‚‰å…¨ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆã‚’èª­ã¿è¾¼ã‚€

#### 5.2 ã‚³ãƒŸãƒƒãƒˆã®numstatã‚’å–å¾—ï¼ˆã“ã“ãŒé‡è¦ï¼ï¼‰
- `git show --numstat --format= <commit-hash>` ã‚’å®Ÿè¡Œ
- **å®Ÿéš›ã«ã‚³ãƒŸãƒƒãƒˆã«å«ã¾ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã®å¤‰æ›´**ã‚’å–å¾—
- numstatå½¢å¼: `<added>\t<deleted>\t<filepath>`

**ä¾‹**:
```
10    2    main.go
5     0    utils.go
```

#### 5.3 å„ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆã®Changesã‚’é›†ç´„
- ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆç¾¤ã‹ã‚‰å¤‰æ›´æƒ…å ±ã‚’æŠ½å‡º
- **numstatã¨ç…§åˆ**ã—ã¦ã€å®Ÿéš›ã«ã‚³ãƒŸãƒƒãƒˆã«å«ã¾ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿ã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
- ãƒ•ã‚¡ã‚¤ãƒ«ã”ã¨ã«ä½œæˆè€…æƒ…å ±ã‚’é›†ç´„

**é‡è¦**: numstatã«å«ã¾ã‚Œãªã„ãƒ•ã‚¡ã‚¤ãƒ«ã¯é™¤å¤–ã•ã‚Œã‚‹
- ä¾‹: å‰å›ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§ç·¨é›†ã—ãŸãŒã€ä»Šå›ã®ã‚³ãƒŸãƒƒãƒˆã«ã¯å«ã¾ã‚Œãªã„ãƒ•ã‚¡ã‚¤ãƒ«

#### 5.4 Authorship Logã«å¤‰æ›ã—ã¦Git notesã«ä¿å­˜
- ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’Authorship Logå½¢å¼ã«å¤‰æ›
- Git notes (`refs/aict/authorship`) ã«ä¿å­˜
- ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆã‚’ã‚¯ãƒªã‚¢ï¼ˆãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ã®ã¿ä¿æŒï¼‰

**Authorship Logæ§‹é€ **:
```json
{
  "version": "1.0",
  "commit": "abc123def456...",
  "timestamp": "2025-12-10T12:10:00Z",
  "files": {
    "main.go": {
      "authors": [
        {
          "name": "y-hirakaw",
          "type": "human",
          "lines": [[1, 5]],
          "metadata": {}
        },
        {
          "name": "Claude Code",
          "type": "ai",
          "lines": [[6, 15]],
          "metadata": {
            "model": "claude-sonnet-4.5"
          }
        }
      ]
    },
    "utils.go": {
      "authors": [
        {
          "name": "Claude Code",
          "type": "ai",
          "lines": [[1, 5]],
          "metadata": {
            "model": "claude-sonnet-4.5"
          }
        }
      ]
    }
  }
}
```

## numstatãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã®é‡è¦æ€§

### ãªãœnumstatã¨ç…§åˆã™ã‚‹ã®ã‹

**å•é¡Œ**: ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆã«ã¯éå»ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§ç·¨é›†ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ãŒæ®‹ã£ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹

**ä¾‹**:
- ã‚»ãƒƒã‚·ãƒ§ãƒ³1: `AndroidNativeApp/MainActivity.kt` ã‚’ç·¨é›† â†’ ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆè¨˜éŒ²
- ã‚»ãƒƒã‚·ãƒ§ãƒ³2: `iOSNativeApp/Info.plist` ã‚’ç·¨é›† â†’ ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆè¨˜éŒ²
- ã‚³ãƒŸãƒƒãƒˆ: `iOSNativeApp/Info.plist` ã®ã¿ã‚’ã‚³ãƒŸãƒƒãƒˆ

**æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œ**:
- Authorship Logã«ã¯ `iOSNativeApp/Info.plist` ã®ã¿ãŒå«ã¾ã‚Œã‚‹ã¹ã
- `AndroidNativeApp/MainActivity.kt` ã¯å«ã¾ã‚Œãªã„ï¼ˆã‚³ãƒŸãƒƒãƒˆã•ã‚Œã¦ã„ãªã„ãŸã‚ï¼‰

**å®Ÿè£…**:
```go
// handlers_commit.go

// ã‚³ãƒŸãƒƒãƒˆã®numstatã‚’å–å¾—
numstatOutput, err := executor.Run("show", "--numstat", "--format=", commitHash)

// numstatã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ï¼ˆå®Ÿéš›ã«å¤‰æ›´ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿ï¼‰
changedFiles := parseNumstatFiles(numstatOutput)

// ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆç¾¤ã‚’Authorship Logã«å¤‰æ›ï¼ˆnumstatã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ï¼‰
log, err := authorship.BuildAuthorshipLog(checkpoints, commitHash, changedFiles)
```

```go
// internal/authorship/builder.go

func BuildAuthorshipLog(checkpoints []*tracker.CheckpointV2, commitHash string, changedFiles map[string]bool) (*tracker.AuthorshipLog, error) {
    // ...
    for _, cp := range checkpoints {
        for filepath, change := range cp.Changes {
            // numstatãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°: å®Ÿéš›ã«å¤‰æ›´ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿å«ã‚ã‚‹
            if changedFiles != nil && !changedFiles[filepath] {
                continue // ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯å®Ÿéš›ã«ã¯å¤‰æ›´ã•ã‚Œã¦ã„ãªã„ã®ã§ã‚¹ã‚­ãƒƒãƒ—
            }
            // ... Authorship Logã«è¿½åŠ 
        }
    }
}
```

## ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼å›³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Pre-tool-use    â”‚
â”‚ Hook            â”‚ â†’ äººé–“ã®ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆè¨˜éŒ²
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Claude Code     â”‚
â”‚ ç·¨é›†            â”‚ â†’ AIãŒã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Post-tool-use   â”‚
â”‚ Hook            â”‚ â†’ AIã®ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆè¨˜éŒ²
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   (å·®åˆ†è¨ˆç®—)
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ git commit      â”‚ â†’ ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚³ãƒŸãƒƒãƒˆ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Post-commit     â”‚
â”‚ Hook            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ aict commit     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. ãƒã‚§ãƒƒã‚¯     â”‚ â†’ ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆç¾¤ã‚’èª­ã¿è¾¼ã¿
â”‚    ãƒã‚¤ãƒ³ãƒˆ     â”‚
â”‚    èª­ã¿è¾¼ã¿     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2. numstat      â”‚ â†’ git show --numstat
â”‚    å–å¾—         â”‚   (å®Ÿéš›ã®å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 3. ãƒ•ã‚£ãƒ«ã‚¿     â”‚ â†’ numstatã¨ç…§åˆ
â”‚    ãƒªãƒ³ã‚°       â”‚   (é‡è¦ï¼)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 4. Authorship   â”‚ â†’ Git notesã«ä¿å­˜
â”‚    Logç”Ÿæˆ      â”‚   (refs/aict/authorship)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«

`.git/aict/config.json`:
```json
{
  "target_ai_percentage": 80.0,
  "tracked_extensions": [".go", ".py", ".js", ".ts", ".java", ".kt", ".swift"],
  "exclude_patterns": ["*_test.go", "vendor/*", "node_modules/*"],
  "default_author": "y-hirakaw",
  "ai_agents": ["Claude Code", "GitHub Copilot", "ChatGPT"]
}
```

## ã‚³ãƒãƒ³ãƒ‰ä¸€è¦§

| ã‚³ãƒãƒ³ãƒ‰ | èª¬æ˜ |
|---------|------|
| `aict init` | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®åˆæœŸåŒ– |
| `aict setup-hooks` | Claude Code & Git hooks ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ— |
| `aict checkpoint --author <name>` | æ‰‹å‹•ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆè¨˜éŒ² |
| `aict commit` | Authorship Logç”Ÿæˆï¼ˆè‡ªå‹• or æ‰‹å‹•ï¼‰ |
| `aict report --since <date>` | ãƒ¬ãƒãƒ¼ãƒˆè¡¨ç¤º |
| `aict sync push/fetch` | ãƒªãƒ¢ãƒ¼ãƒˆã¨ã®åŒæœŸ |
| `aict debug show` | ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆè¡¨ç¤º |
| `aict debug clean` | ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆå‰Šé™¤ |
| `aict debug clear-notes` | Git noteså‰Šé™¤ |

## ãƒ¬ãƒãƒ¼ãƒˆä¾‹

```
ğŸ“Š AI Code Generation Report (since 7d)

Commits: 5
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ã€ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹è²¢çŒ®ã€‘ï¼ˆæœ€çµ‚çš„ãªã‚³ãƒ¼ãƒ‰é‡ã¸ã®å¯„ä¸ï¼‰
  ç·å¤‰æ›´è¡Œæ•°: 52è¡Œ
    ğŸ¤– AIè¿½åŠ :        2è¡Œ (3.8%)
    ğŸ‘¤ äººé–“è¿½åŠ :     50è¡Œ (96.2%)

ã€ä½œæ¥­é‡è²¢çŒ®ã€‘ï¼ˆå®Ÿéš›ã®ä½œæ¥­é‡ï¼‰
  ç·ä½œæ¥­é‡: 146è¡Œ
    ğŸ¤– AIä½œæ¥­:       29è¡Œ (19.9%)
       â”” è¿½åŠ : 2è¡Œ, å‰Šé™¤: 27è¡Œ
    ğŸ‘¤ äººé–“ä½œæ¥­:    117è¡Œ (80.1%)
       â”” è¿½åŠ : 50è¡Œ, å‰Šé™¤: 67è¡Œ

By Author:
  ğŸ‘¤ y-hirakaw                50è¡Œè¿½åŠ  (96.2%) - 5 commits
  ğŸ¤– Claude Code               2è¡Œè¿½åŠ  (3.8%) - 1 commits
```

## é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ

1. **ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆ**: pre/post-tool-use hookã§è¨˜éŒ²
2. **ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ**: ãƒ•ã‚¡ã‚¤ãƒ«ã®çŠ¶æ…‹ã‚’å®Œå…¨ã«ä¿å­˜
3. **å·®åˆ†è¨ˆç®—**: å‰å›ã®ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã¨ã®å·®åˆ†
4. **numstatãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°**: ã‚³ãƒŸãƒƒãƒˆã«å«ã¾ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿ã‚’è¿½è·¡ï¼ˆæœ€é‡è¦ï¼ï¼‰
5. **Authorship Log**: Git notesã¨ã—ã¦æ°¸ç¶šåŒ–
6. **ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ**: è¤‡æ•°ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã§å¯è¦–åŒ–

ã“ã®ä»•æ§˜ã«åŸºã¥ã„ã¦ã€AICTã¯AIã¨äººé–“ã®ã‚³ãƒ¼ãƒ‰è²¢çŒ®ã‚’æ­£ç¢ºã«è¿½è·¡ãƒ»ç®¡ç†ã—ã¾ã™ã€‚
